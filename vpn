Description='ETS-VPN'
Interface=vpn
Connection=tuntap
Mode=tun

BindsToInterfaces=(enp0s25 wlp3s0)
IP=no

PIDFILE=/run/openconnect_${Interface}.pid
SERVER=accesvpn.etsmtl.ca
LOCAL_USERNAME=etienne
REMOTE_USERNAME=etienne.st-amant-audet.1@ens.etsmtl.ca
PASSWORD="`su ${LOCAL_USERNAME} -c "pass ets/vpn" | head -n 1`" 

ExecUpPost="echo '${PASSWORD}' | /usr/bin/openconnect --background --pid-file=${PIDFILE} --interface='${Interface}' --user='${REMOTE_USERNAME}' --passwd-on-stdin ${SERVER}"
ExecDownPre="kill -INT $(cat ${PIDFILE}) ; resolvconf -d ${Interface} ; ip link delete ${Interface}"
